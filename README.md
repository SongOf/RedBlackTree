# 红黑树

### 二分查找
```aidl
缺点：
    依赖有序数组
    数组为连续空间的线性表 无法快速插入 需要扩容
    但单链表不能支持二分查找 因此提出二叉搜索树
```

### 二叉搜索树
```aidl
缺点：
    退化成线性链表 查询性能由O(logn)退化到O(n)
    因此提出二叉平衡树
```
### AVL
```aidl
1、具有二叉搜索树的特点
2、每个节点的左子树与右子树的高度差至多等于1
```
```aidl
评价AVL
    1、解决二叉搜索树退化为近似链表的缺点，查询性能稳定O(logn)
    2、但要求严格，几乎每次插入删除都需要通过左旋、右旋调整 在插入删除频繁的场景性能大打折扣
    3、折中处理：红黑树
```
### 红黑树
```aidl
红黑树性质：
    1、每个节点要么是红色 要么是黑色
    2、根节点是黑色
    3、每个叶子节点（NIL）是黑色
    4、每个红色节点的子节点一定都是黑色 不能有两个红色节点相连
    5、任意节点到每个叶子节点的路径都包含数量相同的黑结点 即黑高
    5.1、如果一个结点存在黑子节点，那么该结点肯定有两个子节点
```
![](docs\blt.png)
```aidl
红黑树评价：
    红黑树并不是完美平衡二叉树，而是黑色完美平衡：性质5 
    趋近平衡状态
```
```aidl
红黑树平衡操作：
    变色：
    左旋：以某个节点为支点（旋转节点） 其右子结点变为旋转节点的父结点 右子结点的左子结点变为旋转结点的右子结点 其他不变
    右旋：以某个节点为支点（旋转节点） 其左子结点变为旋转节点的父结点 左子结点的右子结点变为旋转结点的左子结点 其他不变
```
![](docs\leftratio.png)
![](docs\rightratio.png)
```aidl
红黑树查找：
    同二叉搜索树
```
```aidl
红黑树插入：
    0、插入节点一定是红色（黑色插入一定为破坏平衡 红色则不一定）
    1、查找插入位置
    2、插入后自平衡
红黑树插入情况：
    1、空树，插入节点为根 变黑即可
    2、插入节点已存在，直接更新节点值
    3、插入节点的父节点为黑节点，直接插入 无需自平衡
```
![](docs\insertpb.png)
```aidl
    4、插入节点的父节点为红色 平衡情况如下：
```
```aidl
    4.1、叔叔节点存在且为红色
```
![](docs\1.png)
```aidl
    4.2、叔叔节点不存在或为黑色，并且插入节点的父节点是祖先节点的左子结点，分两种情况
```
![](docs\2.png)
```aidl
    4.2.1、插入节点为父节点的左子结点
```
![](docs\RR.png)
```aidl
    4.2.2、插入节点为父节点的右子结点
```
![](docs\LR.png)
```aidl
    4.3、叔叔节点不存在或为黑色，并且插入节点的父节点是祖先节点的右子结点，对应4.2
    4.3.1、插入节点为父节点的右子结点
```
![](docs\RR1.png)
```aidl
    4.3.2、插入节点为父节点的左子结点
    注：图中第一次为右旋
```
![](docs\RL.png)
```aidl
示例：
```
![](docs\demo.png)
